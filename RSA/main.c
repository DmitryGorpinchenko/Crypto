/*
 * compile with gcc main.c RSA.c -lgmp
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#include "RSA.h"

int main(void) 
{	
    char *p = "13407807929942597099574024998205846127479365820592393377723561443721764030073662768891111614362326998675040546094339320838419523375986027530441562135724301";
    char *q = "13407807929942597099574024998205846127479365820592393377723561443721764030073778560980348930557750569660049234002192590823085163940025485114449475265364281";
    char *cipher = "22096451867410381776306561134883418017410069787892831071731839143676135600120538004282329650473509424343946219751512256465839967942889460764542040581564748988013734864120452325229320176487916666402997509188729971690526083222067771600019329260870009579993724077458967773697817571267229951148662959627934791540";
	
    mpz_t e;
    mpz_init_set_ui(e, 65537);

    RSA *rsa = init_RSA(p, q, e);

    char *msg = decrypt(rsa, cipher);

    printf("Message: [%s]\n", msg);
	
    mpz_clear(e);
    free(msg);
    free_RSA(rsa);
    return 0;
}
